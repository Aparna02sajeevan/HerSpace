{% extends 'base.html' %}

{% block content %}

<style>
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    @keyframes slideDown {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .fade-in { animation: fadeIn 0.8s ease-out; }
    .pulse-card { animation: pulse 2s ease-in-out infinite; }
    .slide-down { animation: slideDown 0.6s ease-out; }

    .glass-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 20px 60px rgba(106, 90, 205, 0.15);
    }

    .affirmation-count {
        display: inline-block;
        background: linear-gradient(135deg, #a78bfa, #ec4899);
        color: white;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        margin-top: 8px;
    }

    .btn-base {
        padding: 8px 32px;
        font-weight: 600;
        border-radius: 12px;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
        font-size: 16px;
    }

    .btn-base:hover {
        transform: scale(1.05);
    }

    .btn-base:active {
        transform: scale(0.95);
    }

    .btn-primary {
        background: linear-gradient(135deg, #6a5acd 0%, #a78bfa 100%);
        color: white;
        box-shadow: 0 4px 15px rgba(106, 90, 205, 0.3);
    }

    .btn-primary:hover {
        background: linear-gradient(135deg, #7c63d8 0%, #b89ff0 100%);
        box-shadow: 0 8px 25px rgba(106, 90, 205, 0.4);
    }

    .btn-secondary {
        background: #ec4899;
        color: white;
    }

    .btn-secondary:hover {
        background: #db2777;
    }

    .btn-outline {
        background: transparent;
        border: 2px solid #6a5acd;
        color: #6a5acd;
    }

    .btn-outline:hover {
        background: #6a5acd;
        color: white;
    }

    .favorite-star {
        cursor: pointer;
        font-size: 32px;
        transition: all 0.3s ease;
    }

    .favorite-star.favorited {
        animation: pulse 0.6s ease;
    }

    .button-group {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        justify-content: center;
        margin: 16px 0;
    }

    .button-group button {
        padding: 8px 16px;
        border-radius: 8px;
        border: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .affirmation-card {
        position: relative;
        cursor: pointer;
    }

    .card-actions {
        display: flex;
        gap: 12px;
        justify-content: center;
        margin-top: 12px;
    }

    .icon-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: none;
        cursor: pointer;
        font-size: 18px;
        transition: all 0.3s ease;
        background: #f3f4f6;
    }

    .icon-btn:hover {
        background: #6a5acd;
        color: white;
        transform: scale(1.1);
    }

    .tips-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 16px;
        margin-top: 20px;
    }

    .tip-card {
        padding: 16px;
        border-left: 4px solid #6a5acd;
        background: #f9f5ff;
        border-radius: 8px;
    }

    .tip-card strong {
        color: #6a5acd;
    }

    .counter {
        background: #f3f4f6;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        color: #666;
    }
</style>

<div class="max-w-5xl mx-auto min-h-screen py-12 px-4">
    
    <!-- Header -->
    <div class="fade-in text-center mb-12">
        <h1 class="text-6xl font-bold text-gray-900 mb-3" style="font-family: 'Playfair Display', serif;">
            ‚ú® Daily Affirmations
        </h1>
        <p class="text-lg text-gray-600">Believe in yourself. You are worthy of success and happiness.</p>
        <div class="affirmation-count">
            Affirmation <span id="currentNum">1</span> of <span id="totalNum">20</span>
        </div>
    </div>

    <!-- Main Affirmation Card -->
    <div class="fade-in glass-card rounded-3xl p-12 md:p-16 shadow-2xl mb-8 max-w-3xl mx-auto pulse-card border-2 border-purple-200 affirmation-card">
        <div class="text-center">
            <div style="text-align: right; margin-bottom: 16px;">
                <span class="favorite-star" id="favStar" onclick="toggleFavorite(event)" title="Add to favorites">ü§ç</span>
            </div>
            <span class="text-6xl mb-6 block">üíú</span>
            <p class="text-2xl md:text-4xl font-bold text-gray-900 mb-8 leading-relaxed" style="font-family: 'Playfair Display', serif;" id="affirmationText">
                Loading affirmation...
            </p>
            <p class="text-gray-500 italic mb-6">Take a moment to internalize this affirmation.</p>
            
            <!-- Action Buttons -->
            <div class="card-actions">
                <button onclick="speakAffirmation()" class="icon-btn" title="Read aloud">
                    üîä
                </button>
                <button onclick="copyAffirmation()" class="icon-btn" title="Copy to clipboard">
                    üìã
                </button>
                <button onclick="shareAffirmation()" class="icon-btn" title="Share">
                    üì§
                </button>
            </div>
        </div>
    </div>

    <!-- Navigation Buttons -->
    <div class="fade-in button-group" style="max-width: 600px; margin: 30px auto;">
        <button onclick="previousAffirmation()" class="btn-base btn-outline">
            ‚Üê Previous
        </button>
        <button onclick="nextAffirmation()" class="btn-base btn-primary">
            Next Affirmation ‚Üí
        </button>
        <button onclick="randomAffirmation()" class="btn-base btn-secondary">
            üé≤ Random
        </button>
    </div>

    <!-- Favorite Affirmations List -->
    <div class="fade-in glass-card rounded-2xl p-8 max-w-3xl mx-auto mb-12 shadow-lg" id="favoritesSection" style="display: none;">
        <h2 class="text-2xl font-bold text-gray-900 mb-6" style="font-family: 'Playfair Display', serif;">üíñ Your Favorites</h2>
        <div id="favoritesList" style="space-y: 8px;"></div>
    </div>

    <!-- Daily Tips Section -->
    <div class="fade-in glass-card rounded-2xl p-8 max-w-3xl mx-auto shadow-lg">
        <h2 class="text-2xl font-bold text-gray-900 mb-6" style="font-family: 'Playfair Display', serif;">üí° Tips for Using Affirmations</h2>
        
        <div class="tips-grid">
            <div class="tip-card">
                <strong>üåÖ Start Your Day</strong>
                <p class="text-sm text-gray-600 mt-2">Read an affirmation every morning to set a positive tone for your day.</p>
            </div>

            <div class="tip-card">
                <strong>üìù Write It Down</strong>
                <p class="text-sm text-gray-600 mt-2">Writing affirmations in your journal helps reinforce them in your mind.</p>
            </div>

            <div class="tip-card">
                <strong>üé§ Say It Out Loud</strong>
                <p class="text-sm text-gray-600 mt-2">Speaking affirmations with conviction makes them more powerful and real.</p>
            </div>

            <div class="tip-card">
                <strong>üßò‚Äç‚ôÄÔ∏è Believe It</strong>
                <p class="text-sm text-gray-600 mt-2">Truly believe in what you're saying. Affirmations work best with genuine faith.</p>
            </div>

            <div class="tip-card">
                <strong>‚è∞ Practice Daily</strong>
                <p class="text-sm text-gray-600 mt-2">Make affirmations a daily habit for maximum impact and lasting change.</p>
            </div>

            <div class="tip-card">
                <strong>üåô Before Sleep</strong>
                <p class="text-sm text-gray-600 mt-2">Repeat affirmations before bed to let them work in your subconscious mind.</p>
            </div>
        </div>
    </div>

    <!-- Back Button -->
    <div class="fade-in text-center mt-12">
        <a href="{% url 'dashboard' %}" class="inline-block px-8 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold rounded-xl transition-all transform hover:scale-105">
            ‚Üê Back to Dashboard
        </a>
    </div>

</div>

<script>
    // Comprehensive affirmations list
    const affirmations = [
        "You are capable of achieving great things.",
        "Your voice matters and deserves to be heard.",
        "You are stronger than your fears.",
        "Progress is more important than perfection.",
        "You deserve to be happy and successful.",
        "Every challenge is an opportunity to grow.",
        "You are worthy of love and respect.",
        "Your potential is unlimited.",
        "You can overcome any obstacle.",
        "You are resilient and brave.",
        "Today is the start of something amazing.",
        "You make a difference in the world.",
        "Your dreams are worth pursuing.",
        "You are becoming the best version of yourself.",
        "You have the power to create change.",
        "You are enough, just as you are.",
        "Success is within your reach.",
        "You bring joy to those around you.",
        "Trust yourself and your abilities.",
        "You are a source of inspiration to others."
    ];

    let currentIndex = 0;
    let favorites = JSON.parse(localStorage.getItem('favoriteAffirmations')) || [];

    function updateDisplay() {
        const affirmation = affirmations[currentIndex];
        document.getElementById('affirmationText').textContent = affirmation;
        document.getElementById('currentNum').textContent = currentIndex + 1;
        document.getElementById('totalNum').textContent = affirmations.length;
        
        // Update star
        const star = document.getElementById('favStar');
        if (favorites.includes(affirmation)) {
            star.textContent = '‚ù§Ô∏è';
            star.classList.add('favorited');
        } else {
            star.textContent = 'ü§ç';
            star.classList.remove('favorited');
        }

        // Update favorites section
        updateFavoritesDisplay();
    }

    function nextAffirmation() {
        currentIndex = (currentIndex + 1) % affirmations.length;
        updateDisplay();
    }

    function previousAffirmation() {
        currentIndex = (currentIndex - 1 + affirmations.length) % affirmations.length;
        updateDisplay();
    }

    function randomAffirmation() {
        currentIndex = Math.floor(Math.random() * affirmations.length);
        updateDisplay();
    }

    function toggleFavorite(event) {
        const affirmation = affirmations[currentIndex];
        if (favorites.includes(affirmation)) {
            favorites = favorites.filter(a => a !== affirmation);
        } else {
            favorites.push(affirmation);
        }
        localStorage.setItem('favoriteAffirmations', JSON.stringify(favorites));
        updateDisplay();
    }

    function speakAffirmation() {
        const affirmation = affirmations[currentIndex];
        const utterance = new SpeechSynthesisUtterance(affirmation);
        utterance.rate = 0.9;
        utterance.pitch = 1;
        speechSynthesis.speak(utterance);
    }

    function copyAffirmation() {
        const affirmation = affirmations[currentIndex];
        navigator.clipboard.writeText(affirmation).then(() => {
            alert('‚úì Affirmation copied to clipboard!');
        });
    }

    function shareAffirmation() {
        const affirmation = affirmations[currentIndex];
        const text = `I want to share this affirmation with you:\n\n"${affirmation}"\n\n- From HerSpace`;
        if (navigator.share) {
            navigator.share({
                title: 'Daily Affirmation',
                text: text
            });
        } else {
            alert('Affirmation:\n\n' + affirmation);
        }
    }

    function updateFavoritesDisplay() {
        const favSection = document.getElementById('favoritesSection');
        const favList = document.getElementById('favoritesList');
        
        if (favorites.length > 0) {
            favSection.style.display = 'block';
            favList.innerHTML = favorites.map((fav, idx) => `
                <div style="padding: 12px; background: #f9f5ff; border-left: 4px solid #ec4899; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                    <p style="margin: 0; color: #666;">"${fav}"</p>
                    <button onclick="removeFavorite(${idx})" style="background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px 8px;">‚úï</button>
                </div>
            `).join('');
        } else {
            favSection.style.display = 'none';
        }
    }

    function removeFavorite(idx) {
        favorites.splice(idx, 1);
        localStorage.setItem('favoriteAffirmations', JSON.stringify(favorites));
        updateDisplay();
    }

    // Initialize on load
    function initializeAffirmations() {
        updateDisplay();
    }
    
    // Multiple ways to ensure it initializes
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeAffirmations);
    } else {
        initializeAffirmations();
    }
    
    window.addEventListener('load', initializeAffirmations);
</script>
{% endblock %}